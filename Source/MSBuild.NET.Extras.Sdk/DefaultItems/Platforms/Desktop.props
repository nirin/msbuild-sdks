<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<PropertyGroup>
		<MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
	</PropertyGroup>

	<!-- Desktop Support -->

	<ItemGroup Condition="'$(EnableDefaultSettingsItems)' == 'true'">
		<None Update="**\*.settings" SubType="Designer">
			<Generator Condition="'$(EnableSettingsCodeGenerator)' == 'false'">MSBuild:Compile</Generator>
		</None>
	</ItemGroup>

	<ItemGroup Condition="'$(EnableDefaultSettingsItems)' == 'true' AND '$(EnableSettingsCodeGenerator)' == 'true'">
		<None Update="**\*.settings">
			<Generator>$(SettingsCodeGeneratorTool)</Generator>
			<LastGenOutput>%(Filename)$(DefaultDesignerFileSuffix)$(DefaultLanguageSourceExtension)</LastGenOutput>
		</None>

		<_SettingsFiles Include="**\*.settings">
			<GenFilePath>%(RecursiveDir)%(Filename)$(DefaultDesignerFileSuffix)$(DefaultLanguageSourceExtension)</GenFilePath>
		</_SettingsFiles>

		<Compile Update="@(_SettingsFiles->'%(GenFilePath)')">
			<AutoGen>true</AutoGen>
			<DesignTime>true</DesignTime>
			<DesignTimeSharedInput>true</DesignTimeSharedInput>
			<DependentUpon>$([MSBuild]::ValueOrDefault('%(Filename)', '').Replace('$(DefaultDesignerFileSuffix)', '.settings'))</DependentUpon>
		</Compile>
	</ItemGroup>

	<!-- Windows Forms Support -->

	<ItemGroup>
		<Compile Update="**\*$(DefaultDesignerFileSuffix)$(DefaultLanguageSourceExtension)">
			<DependentUpon Condition="'%(DependentUpon)' == ''">$([MSBuild]::ValueOrDefault('%(Filename)', '').Replace('$(DefaultDesignerFileSuffix)', '$(DefaultLanguageSourceExtension)'))</DependentUpon>
		</Compile>
	</ItemGroup>

	<ItemGroup Condition="'$(EnableDefaultWinFormsItems)' == 'true'">
		<EmbeddedResource Update="**\*.resx" Condition="'$(EnableDefaultEmbeddedResourceItems)' == 'true' AND '$(EnableEmbeddedResourceCodeGenerator)' == 'true'">
			<DependentUpon Condition="'$(DependentUpon)' != ''">$([System.Text.RegularExpressions.Regex]::Replace('%(FileName)', '$(LangIdRegEx)|\$(DefaultDesignerFileSuffix)', '%(DefaultLanguageSourceExtension)'))</DependentUpon>
		</EmbeddedResource>
		<!--
			TODO: Add SubType(s) for Windows Forms Project
			ISSUE: SubType(s) for Windows Forms Project doesn't work in CPS anyway!
		-->
		<Service Include="$(UserControlDesignerService)" Condition="'$(EnableUserControlDesigner)' == 'true'"/>
	</ItemGroup>

	<!-- WEB Support -->

	<ItemGroup Condition="'$(EnableDefaultWebItems)' == 'true'">
		<Service Include="$(WebDesignerService)" Condition="'$(EnableWebDesigner)' == 'true'"/>
	</ItemGroup>

	<ItemGroup Condition="'$(EnableDefaultWebItems)' == 'true' AND '$(EnableDefaultContentItems)' == 'true'">
		<Content Include="$(DefaultWebStyleIncludes)" Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder)"/>
		<Content Include="$(DefaultWebScriptIncludes)" Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder)"/>

		<Content Include="$(DefaultWebPageItemIncludes)" Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder);$(DefaultWebStyleIncludes);$(DefaultWebScriptIncludes)"/>

		<Content Include="**\*.config" Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder);$(DefaultWebStyleIncludes);$(DefaultWebScriptIncludes)">
			<CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
		</Content>
		<Content Update="**\Web.*.config" DependentUpon="Web.config"/>

		<Content Include="**\*.json" Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder);$(DefaultWebPageIncludes);$(DefaultWebStyleIncludes);$(DefaultWebScriptIncludes)">
			<CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
		</Content>

		<!-- Set CopyToPublishDirectory to Never for items under AppDesignerFolder -->
		<Content Update="$(AppDesignerFolder)\**" Condition="'$(AppDesignerFolder)' != ''">
			<CopyToPublishDirectory>Never</CopyToPublishDirectory>
		</Content>

		<Content Include="favicon.ico"/>

		<!-- Remove Content items from other item types -->
		<None Remove="@(Content)"/>
		<Compile Remove="@(Content)"/>
		<EmbeddedResource Remove="@(Content)"/>

		<!-- Keep track of the default content items for later to distinguish them from newly generated content items -->
		<_ContentIncludedByDefault Include="@(Content)"/>
	</ItemGroup>

</Project>
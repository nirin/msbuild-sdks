<Project>

	<!-- 'SourceLanguage' can be empty when entering here -->

	<PropertyGroup Condition="'$(SourceLanguage)' == ''">
		<SourceLanguage Condition="$(MSBuildProjectExtension.EndsWith('proj'))">$(MSBuildProjectExtension.TrimEnd('proj').TrimStart('.'))</SourceLanguage>
	</PropertyGroup>

	<!--
		$(SourceLanguage) = $(LangId)$(LangVersion)
	-->
	<PropertyGroup>
		<LangId>$(SourceLanguage.TrimEnd('.0123456789'))</LangId>
		<LangVersion>$(SourceLanguage.Substring('$(LangId.Length)'))</LangVersion>
		<LangVersion Condition="'$(LangVersion)' == ''">Latest</LangVersion>
	</PropertyGroup>

	<Choose>
		<When Condition="'$(LangId)' == 'cs'">
			<PropertyGroup>
				<SourceLanguageName>CSharp</SourceLanguageName>
				<SourceLanguageSymbol>C#</SourceLanguageSymbol>
				<SourceLanguageExtension>.cs</SourceLanguageExtension>
			</PropertyGroup>
		</When>

		<When Condition="'$(LangId)' == 'fs'">
			<PropertyGroup>
				<SourceLanguageName>FSharp</SourceLanguageName>
				<SourceLanguageSymbol>F#</SourceLanguageSymbol>
				<SourceLanguageExtension>.fs</SourceLanguageExtension>
			</PropertyGroup>
		</When>

		<When Condition="'$(LangId)' == 'vb'">
			<PropertyGroup>
				<SourceLanguageName>VisualBasic</SourceLanguageName>
				<SourceLanguageSymbol>VB</SourceLanguageSymbol>
				<SourceLanguageExtension>.vb</SourceLanguageExtension>
			</PropertyGroup>
		</When>

		<When Condition="'$(LangId)' == 'il'">
			<PropertyGroup>
				<SourceLanguageName>IntermediateLanguage</SourceLanguageName>
				<SourceLanguageSymbol>IL</SourceLanguageSymbol>
				<SourceLanguageExtension>.il</SourceLanguageExtension>
			</PropertyGroup>
		</When>

		<Otherwise>
			<PropertyGroup>
				<SourceLanguageName>Common</SourceLanguageName>
			</PropertyGroup>
		</Otherwise>
	</Choose>

	<PropertyGroup>
		<_ResolvedSourceLanguage>true</_ResolvedSourceLanguage>
	</PropertyGroup>

</Project>